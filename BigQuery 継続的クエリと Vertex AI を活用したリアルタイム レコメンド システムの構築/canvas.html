<!DOCTYPE html>
<html lang="ja" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>リアルタイムレコメンドシステム: インタラクティブレポート</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Indigo & Slate -->
    <!-- Application Structure Plan: A problem-solution narrative structure. It starts by clearly defining the problem with traditional recommendation systems. It then outlines the key improvement points and challenges. The core of the SPA is the detailed architecture diagram, broken down and explained. It then details the project learnings (successes and challenges) and concludes with a final summary. This structure logically guides the user from the "why" (the problem) to the "how" (the solution) and "what was learned" (the outcomes). -->
    <!-- Visualization & Content Choices: 
        - Traditional System Flow: Goal: Show Process. Method: HTML/CSS diagram. Justification: A simple visual flow is more effective than text alone to explain the batch processing loop.
        - Challenges/Improvement Points: Goal: Inform/Organize. Method: Numbered list with distinct visual blocks. Justification: Clearly separates user-facing issues from organizational ones.
        - Overall Architecture & Details: Goal: Organize/Inform. Method: A detailed HTML/CSS diagram with interactive overlays/steps to explain the flow. Justification: Avoids static images, making the diagram responsive and allowing for a guided explanation of a complex system.
        - Team Roles & Learnings: Goal: Compare/Inform. Method: Side-by-side column layout and lists. Justification: Clearly contrasts roles and presents key takeaways from the project.
        - Summary: Goal: Summarize. Method: Numbered list with strong visual cues. Justification: Effectively highlights the main achievements of the project. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Noto Sans JP', sans-serif;
            background-color: #f8fafc;
            color: #1e293b;
        }
        .diagram-box {
            border: 1px solid #d1d5db;
            background-color: white;
            padding: 1rem 1.5rem;
            border-radius: 0.75rem;
            text-align: center;
            transition: all 0.2s ease-in-out;
            box-shadow: 0 1px 3px 0 rgb(0 0 0 / 0.05);
        }
        .diagram-box:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
        }
        .arrow-loop {
            position: relative;
            width: 100%;
            height: 50px;
        }
        .arrow-loop::before {
            content: '';
            position: absolute;
            left: 10%;
            top: 0;
            width: 80%;
            height: 50px;
            border: 3px solid #6366f1;
            border-bottom: none;
            border-radius: 50px 50px 0 0;
        }
         .arrow-loop::after {
            content: '▶';
            position: absolute;
            right: 8%;
            top: -12px;
            font-size: 1.5rem;
            color: #6366f1;
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-800">

    <header class="bg-white/80 backdrop-blur-lg sticky top-0 z-50 shadow-sm">
        <nav class="container mx-auto px-6 py-3 flex justify-between items-center">
            <div class="text-2xl font-bold text-indigo-600">
                Real-time<span class="text-slate-600"> RecSys</span>
            </div>
            <div class="hidden md:flex flex-wrap space-x-6">
                <a href="#problem" class="text-slate-600 hover:text-indigo-600 transition">従来の問題点</a>
                <a href="#challenges" class="text-slate-600 hover:text-indigo-600 transition">検討課題</a>
                <a href="#architecture" class="text-slate-600 hover:text-indigo-600 transition">アーキテクチャ</a>
                <a href="#learnings" class="text-slate-600 hover:text-indigo-600 transition">学び</a>
                <a href="#summary" class="text-slate-600 hover:text-indigo-600 transition">まとめ</a>
            </div>
        </nav>
    </header>

    <main>
        <section id="problem" class="py-20 bg-white">
            <div class="container mx-auto px-6">
                <div class="text-center mb-12">
                    <h1 class="text-4xl md:text-5xl font-bold text-slate-900 mb-4">従来のレコメンドシステム</h1>
                    <p class="text-lg text-slate-600 max-w-2xl mx-auto">バッチ処理に依存する従来システムでは、ユーザーの「今」の興味を捉えきれない課題がありました。</p>
                </div>
                <div class="max-w-2xl mx-auto">
                    <div class="bg-slate-100 p-8 rounded-xl border">
                        <div class="flex justify-center items-center mb-4">
                            <div class="text-5xl">👤</div>
                        </div>
                        <div class="arrow-loop"></div>
                        <div class="flex justify-between items-center text-center mt-4">
                            <div>
                                <p class="font-semibold">行動ログ</p>
                            </div>
                            <div class="diagram-box bg-indigo-200">バッチ処理</div>
                            <div>
                                <p class="font-semibold">反映 (1日後)</p>
                            </div>
                        </div>
                        <ul class="mt-8 space-y-2 list-disc list-inside text-slate-700">
                            <li>データ更新は1日1回</li>
                            <li>バッチ処理でレコメンド結果を更新</li>
                            <li>ユーザーの行動が反映されるのは<span class="font-bold text-red-600">1日後</span></li>
                            <li>レコメンドは<span class="font-bold">過去の</span>興味関心に基づく</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <section id="challenges" class="py-20">
            <div class="container mx-auto px-6">
                <div class="text-center mb-12">
                    <h2 class="text-3xl md:text-4xl font-bold text-slate-900">リアルタイムレコメンドシステム検討課題</h2>
                    <p class="text-lg text-slate-600 mt-4 max-w-2xl mx-auto">u2i (user to item) でのリアルタイム化を目指し、ユーザー課題と組織課題の両面から検討を進めました。</p>
                </div>
                <div class="max-w-3xl mx-auto space-y-6">
                    <div class="p-6 bg-white rounded-lg shadow-md">
                        <h3 class="text-xl font-semibold mb-4 text-red-600">ユーザー課題</h3>
                        <ol class="list-decimal list-inside space-y-3">
                            <li><span class="font-bold">サイト滞在中のレコメンド反映:</span> 検索や閲覧などの行動を即座に反映する。</li>
                            <li><span class="font-bold">現在の興味関心とのズレ:</span> 前回の訪問から時間が経過したユーザーに対してのズレを少なくする。</li>
                            <li><span class="font-bold">新規ユーザーへのレコメンド:</span> 新規ユーザーへもレコメンドを提示できるようにする。</li>
                        </ol>
                    </div>
                     <div class="p-6 bg-white rounded-lg shadow-md">
                        <h3 class="text-xl font-semibold mb-4 text-blue-600">組織課題</h3>
                        <ol class="list-decimal list-inside space-y-3" start="4">
                            <li><span class="font-bold">MLエンジニアとMLOpsエンジニアの責任分界点:</span> 両者の役割と扱うコンポーネントを明確にする。</li>
                            <li><span class="font-bold">素早いプロダクトローンチ:</span> 安全に素早く開発を行う体制を構築する。</li>
                        </ol>
                    </div>
                </div>
            </div>
        </section>

        <section id="architecture" class="py-20 bg-white">
            <div class="container mx-auto px-6">
                <div class="text-center mb-12">
                    <h2 class="text-3xl md:text-4xl font-bold text-slate-900">アーキテクチャと技術選定</h2>
                    <p class="text-lg text-slate-600 mt-4 max-w-2xl mx-auto">Google Cloudのマネージドサービスを活用し、リアルタイム性と開発効率を両立するアーキテクチャを構築。</p>
                </div>
                <div class="bg-slate-50 p-6 sm:p-10 rounded-xl border mb-12">
                     <h3 class="text-2xl font-semibold text-center mb-6">アーキテクチャ全体像</h3>
                    <img src="http://googleusercontent.com/file_content/8" alt="アーキテクチャ全体像" class="rounded-lg shadow-md mx-auto max-w-full h-auto">
                </div>
                 <div class="max-w-4xl mx-auto space-y-8">
                    <h3 class="text-2xl font-semibold text-center">なぜ継続的クエリを採用したか？</h3>
                     <div class="p-8 bg-white rounded-lg shadow-md">
                        <div class="flex items-start">
                            <div class="flex-shrink-0 flex items-center justify-center w-10 h-10 bg-indigo-500 text-white font-bold rounded-full mr-6">1</div>
                            <div>
                                <h4 class="text-xl font-bold mb-2">GA4連携によるリアルタイムデータ基盤の存在</h4>
                                <ul class="list-disc list-inside space-y-2 text-slate-700">
                                    <li>GA4 -> BigQueryのストリーミングエクスポート機能</li>
                                    <li>イベントが数秒〜1分程度でBigQueryに連携</li>
                                    <li>内製の共通タグ配信API + Server-side GTM</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="p-8 bg-white rounded-lg shadow-md">
                        <div class="flex items-start">
                            <div class="flex-shrink-0 flex items-center justify-center w-10 h-10 bg-indigo-500 text-white font-bold rounded-full mr-6">2</div>
                            <div>
                                <h4 class="text-xl font-bold mb-2">SQLでストリーミング処理を実装可能</h4>
                                 <ul class="list-disc list-inside space-y-2 text-slate-700">
                                    <li>MLエンジニアが使い慣れたSQLだけで完結</li>
                                    <li>複雑になりがちなストリーミング処理フレームワークの学習コストが不要</li>
                                    <li>開発のアジリティ向上（MLエンジニアが一人で高速に実装・改善可能）</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="learnings" class="py-20">
            <div class="container mx-auto px-6">
                <div class="text-center mb-12">
                    <h2 class="text-3xl md:text-4xl font-bold text-slate-900">プロジェクトの学び</h2>
                    <p class="text-lg text-slate-600 mt-4 max-w-2xl mx-auto">プロジェクトを通じて得られた成功体験と、乗り越えた課題。</p>
                </div>
                <div class="max-w-5xl mx-auto grid lg:grid-cols-2 gap-8">
                    <!-- What went well -->
                    <div class="space-y-8">
                        <h3 class="text-2xl font-bold text-center text-green-600">うまくいったこと</h3>
                        <div class="bg-green-50 p-8 rounded-lg border border-green-200">
                            <h4 class="text-xl font-semibold mb-2">ML/MLOpsエンジニアの分業</h4>
                            <p>責任分界点を明確にし、チームのパフォーマンスを最大化。</p>
                        </div>
                        <div class="bg-green-50 p-8 rounded-lg border border-green-200">
                            <h4 class="text-xl font-semibold mb-2">既存資産の活用</h4>
                            <p>既に構築済みのシステム基盤を活かし、新規実装部分をシンプルかつスピーディに実現。</p>
                        </div>
                        <div class="bg-green-50 p-8 rounded-lg border border-green-200">
                            <h4 class="text-xl font-semibold mb-2">Bigtableのテーブル設計</h4>
                            <p>オンラインFeature storeとして採用。ベストプラクティスに基づき、低レイテンシで安定稼働するスキーマを設計。</p>
                        </div>
                    </div>
                    <!-- Challenges -->
                    <div class="space-y-8">
                        <h3 class="text-2xl font-bold text-center text-red-600">苦労したこと</h3>
                         <div class="bg-red-50 p-8 rounded-lg border border-red-200">
                            <h4 class="text-xl font-semibold mb-2">継続的クエリのジョブ管理</h4>
                            <p>GA4の日付シャーディングテーブルに対応するため、新しいテーブルの存在をポーリングし、クエリを切り替える内製ジョブ管理システムを構築。</p>
                        </div>
                         <div class="bg-red-50 p-8 rounded-lg border border-red-200">
                            <h4 class="text-xl font-semibold mb-2">Vertex AI Endpointの日次更新</h4>
                            <p>Private endpointの制約を回避するため、Vertex AI PipelinesでKFPコンポーネントを作成し、トラフィック切り替えを自動化。</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        
        <section id="summary" class="py-20 bg-white">
            <div class="container mx-auto px-6">
                 <div class="text-center mb-12">
                    <h2 class="text-3xl md:text-4xl font-bold text-slate-900">まとめ</h2>
                 </div>
                 <div class="max-w-2xl mx-auto bg-indigo-50 p-8 rounded-xl border-2 border-indigo-200 space-y-6">
                    <div class="flex items-center">
                        <div class="flex-shrink-0 flex items-center justify-center w-12 h-12 bg-indigo-500 text-white text-xl font-bold rounded-full mr-5">1</div>
                        <p class="text-lg font-semibold text-slate-800">ユーザーへのレコメンド反映を1日から<span class="text-indigo-600">1分</span>に改善</p>
                    </div>
                    <div class="flex items-center">
                        <div class="flex-shrink-0 flex items-center justify-center w-12 h-12 bg-indigo-500 text-white text-xl font-bold rounded-full mr-5">2</div>
                        <p class="text-lg font-semibold text-slate-800">MLエンジニアがビジネスロジックに<span class="text-indigo-600">集中できる</span>環境を実現</p>
                    </div>
                    <div class="flex items-center">
                        <div class="flex-shrink-0 flex items-center justify-center w-12 h-12 bg-indigo-500 text-white text-xl font-bold rounded-full mr-5">3</div>
                        <p class="text-lg font-semibold text-slate-800">MLOpsエンジニアは安定稼働と横展開を見据えた<span class="text-indigo-600">共通部分の開発</span>に専念</p>
                    </div>
                 </div>
            </div>
        </section>

    </main>

    <footer class="bg-slate-800 text-slate-300 py-8">
        <div class="container mx-auto px-6 text-center">
            <p>&copy; 2025 Google Cloud Next Tokyo. AIによって生成されたインタラクティブレポートです。</p>
        </div>
    </footer>

    <script>
        // No charts in this version, so no Chart.js script needed.
    </script>
</body>
</html>
